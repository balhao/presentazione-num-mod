import{r as Y,L as w,I as C,H as E,O as I,f as R,o as $}from"./modules/vue-Bg1QFOsN.js";import{u as O}from"./slidev/context-Bjg846ux.js";import{_ as T}from"./index-CENSGEDX.js";const u=980,d=552,F=4,W=2,H=2,L=75,q=1e4,z={__name:"SpirographBackground",setup(D){O();const x=Y(null);let l=null,n=null;const a={lineWidth:1.5,stepsPerFrame:5,trailLength:5e3,backgroundFade:.08,hueStart:212,saturation:96,lightness:78,maxOpacity:.85,numBands:20};let f=0,y=1,b=[],r=null,m=0,c=0;function P(){const e=x.value;if(!e)return;const t=2;e.width=u*t,e.height=d*t,n=e.getContext("2d"),n.setTransform(t,0,0,t,0,0),y=Math.min(u,d)/8,b=[{offsetX:0,offsetY:0},{offsetX:u,offsetY:d}]}function M(){f=0,r=new Float32Array(a.trailLength*4),m=0,c=0}function k(e,t,i,o){const s=m*4;r[s]=e,r[s+1]=t,r[s+2]=i,r[s+3]=o,m=(m+1)%a.trailLength,c<a.trailLength&&c++}function p(e,t,i){const o=e/q*2*Math.PI,s=F*Math.cos(o)+W*Math.cos(L*o),h=F*Math.sin(o)+H*Math.sin(L*o);return{x:t+s*y,y:i+h*y}}function A(){const e=b[0],t=b[1];for(let i=0;i<a.stepsPerFrame;i++){const o=p(f,e.offsetX,e.offsetY);f++;const s=p(f,e.offsetX,e.offsetY);k(o.x,o.y,s.x,s.y);const h=p(f-1,t.offsetX,t.offsetY),g=p(f,t.offsetX,t.offsetY);k(h.x,h.y,g.x,g.y)}}function B(){if(n.fillStyle=`rgba(251, 252, 255, ${a.backgroundFade})`,n.fillRect(0,0,u,d),c<2)return;n.lineWidth=a.lineWidth,n.lineCap="round";const e=c<a.trailLength?0:m,t=Math.ceil(c/a.numBands);for(let i=0;i<a.numBands;i++){const o=i*t,s=Math.min((i+1)*t,c);if(o>=c)break;const g=(o+s)/2/c,X=Math.min(g*a.maxOpacity,a.maxOpacity);n.strokeStyle=`hsla(${a.hueStart}, ${a.saturation}%, ${a.lightness}%, ${X})`,n.beginPath();for(let v=o;v<s;v++){const _=(e+v)%a.trailLength*4;n.moveTo(r[_],r[_+1]),n.lineTo(r[_+2],r[_+3])}n.stroke()}}function S(){A(),B(),l=requestAnimationFrame(S)}return w(()=>{x.value&&(P(),M(),n.fillStyle="rgba(251, 252, 255, 1)",n.fillRect(0,0,u,d),S())}),C(()=>{M(),n&&(n.fillStyle="rgba(251, 252, 255, 1)",n.fillRect(0,0,u,d)),l||S()}),E(()=>{l&&(cancelAnimationFrame(l),l=null)}),I(()=>{l&&(cancelAnimationFrame(l),l=null)}),(e,t)=>($(),R("canvas",{ref_key:"canvas",ref:x,class:"spirograph-canvas"},null,512))}},J=T(z,[["__scopeId","data-v-04fb86e6"]]);export{J as _};
